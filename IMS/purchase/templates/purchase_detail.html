{% extends "base.html" %}
{% block content %}
<div class="main-content">
  <h1 class="mb-4">Purchase: {{ purchase.invoice_no }}</h1>
  <p><strong>Supplier:</strong> {{ purchase.supplier.supplier_name }}</p>
  <p><strong>VAT Number:</strong> {{ purchase.supplier.vat_no }}</p>
  <p><strong>Phone Number:</strong> {{ purchase.supplier.phone }}</p>
  <p><strong>Date:</strong> {{ purchase.date|date:"d M, Y" }}</p>

  <div class="card p-3 mt-3">
    <h5>Purchase Items</h5>
    <div class="table-responsive">
      <table class="table table-striped table-hover table-bordered">
        <thead class="table-dark">
          <tr>
            <th>S.No</th>
            <th>Product</th>
            <th>Size</th>
            <th>Length (inch)</th>
            <th>Quantity</th>
            <th>Unit Price (Rs)</th>
            <th>Total Price (Rs)</th>
          </tr>
        </thead>
        <tbody>
          {% for item in purchase.items.all %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ item.product.product_name }}</td>
            <td>{{ item.size_variation.size|default:"-" }}</td>
            <td>{{ item.length_variation.length_in_inch|default:"-" }}</td>
            <td>{{ item.quantity }}</td>
            <td>{{ item.unit_price }}</td>
            <td>{{ item.total_price }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="7" class="text-center">No items found for this purchase.</td>
          </tr>
          {% endfor %}
        </tbody>

        <!-- âœ… Totals as part of the same table -->
        <tfoot class="table-light">
          <tr>
            <td colspan="6" class="text-end"><strong>Total Amount:</strong></td>
            <td><strong>Rs {{ purchase.total_amount }}</strong></td>
          </tr>
          <tr>
            <td colspan="6" class="text-end"><strong>Tax:</strong></td>
            <td><strong>Rs {{ purchase.tax }}</strong></td>
          </tr>
          <tr>
            <td colspan="6" class="text-end"><strong>Grand Amount:</strong></td>
            <td><strong>Rs {{ purchase.Grand_amount }}</strong></td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</div>
{% endblock %}
